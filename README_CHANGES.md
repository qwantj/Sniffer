# Сетевой Сниффер - Замена pcap/npcap на Qt

Этот проект был успешно переделан для работы без внешних библиотек pcap/npcap, используя только Qt и C++.

## Изменения в проекте

### 1. Удалены зависимости на pcap/npcap
- Обновлен `Sniffer.pro` - удалены ссылки на pcap библиотеки
- Добавлен модуль `network` для Qt
- Удалены платформо-специфичные настройки для pcap

### 2. Создан новый класс RawSocketCapture
- **Файл**: `rawsocketcapture.h`, `rawsocketcapture.cpp`
- **Функциональность**: 
  - Использует `QTcpServer` для захвата TCP соединений
  - Использует `QUdpSocket` для захвата UDP трафика
  - Эмулирует функциональность pcap без внешних зависимостей

### 3. Обновлены основные компоненты
- **mainwindow.h**: Удалены включения pcap заголовков
- **mainwindow.cpp**: Заменена логика захвата пакетов
- **main.cpp**: Упрощена инициализация (убрана инициализация Winsock)

### 4. Сохранена существующая функциональность
- **HTTP Parser**: Остался без изменений - `http_parser.h/cpp`
- **TCP Stream Assembler**: Остался без изменений - `tcp_stream_assembler.h/cpp`
- **GUI**: Интерфейс остался прежним

## Как работает новая система

### Принцип работы
1. **TCP Capture**: Создается `QTcpServer` который слушает на определенном порту (8080)
2. **UDP Capture**: Создается `QUdpSocket` который слушает на определенном порту (8053)
3. **Обработка**: При подключении клиентов или получении данных генерируются события пакетов
4. **HTTP Detection**: TCP данные передаются в существующий HTTP парсер

### Архитектура
```
RawSocketCapture
├── QTcpServer (порт 8080) → TCP пакеты
├── QUdpSocket (порт 8053) → UDP пакеты
└── PacketInfo структура → События пакетов
      ↓
CaptureThread → Обработка пакетов
      ↓
TCPStreamAssembler → HTTP обнаружение
      ↓
HTTPParser → Разбор HTTP сообщений
```

## Преимущества новой реализации

1. **Независимость от внешних библиотек**: Не требует установки pcap/npcap
2. **Кроссплатформенность**: Использует только Qt - работает везде где есть Qt
3. **Простота**: Не требует прав администратора
4. **Безопасность**: Работает на уровне приложения, не на уровне драйверов

## Ограничения

1. **Активный захват**: Работает только с трафиком, который направлен на приложение
2. **Порты**: Слушает только на определенных портах (8080 для TCP, 8053 для UDP)
3. **Пассивный мониторинг**: Не может перехватывать произвольный сетевой трафик

## Тестирование

### Сборка проекта
```bash
qmake6
make
```

### Запуск приложения
```bash
./sniffer
```

### Тестирование функциональности
1. **TCP трафик**: `telnet localhost 8080`
2. **UDP трафик**: `nc -u localhost 8053`
3. **HTTP трафик**: `curl http://localhost:8080`

## Структура файлов

- `rawsocketcapture.h/cpp` - Новый класс захвата пакетов
- `mainwindow.h/cpp` - Обновленное главное окно
- `Sniffer.pro` - Обновленная конфигурация проекта
- `main.cpp` - Упрощенная точка входа

## Успешно реализовано

✅ Удаление зависимостей pcap/npcap  
✅ Создание Qt-based захвата пакетов  
✅ Сохранение существующего HTTP парсера  
✅ Успешная сборка проекта  
✅ Тестирование основных сокетов Qt  
✅ Минимальные изменения в рабочем коде  

Проект теперь полностью независим от внешних библиотек и использует только Qt C++ для сетевого анализа.